<!DOCTYPE html>
<html lang="ar"><!-- تم تبسيط CSS وجافا سكربت فقط -->
<body>
  <!-- واجهة كما هي -->
  <div id="tracker"></div>

  <script>
    async function getBinanceInfo(sym) {
      const s = sym.toUpperCase() + 'USDT';
      const [fRate, oi, ls] = await Promise.all([
        fetch(`https://fapi.binance.com/fapi/v1/fundingRate?symbol=${s}&limit=1`).then(r=>r.json()),
        fetch(`https://fapi.binance.com/fapi/v1/openInterest?symbol=${s}`).then(r=>r.json()),
        fetch(`https://fapi.binance.com/futures/data/topLongShortAccountRatio?symbol=${s}&interval=5m&limit=5`).then(r=>r.json())
      ]);
      return {
        funding: fRate[0]?.fundingRate || '—',
        openInterest: oi.openInterest || '—',
        longShort: ls[0]?.longShortRatio || '—'
      };
    }

    async function getBybitInfo(sym) {
      const s = sym.toUpperCase() + 'USDT';
      const [bp, oir] = await Promise.all([
        fetch(`https://api.bybit.com/v2/public/open-interest?symbol=${s}`).then(r=>r.json()),
        fetch(`https://api.bybit.com/v2/public/account-ratio?symbol=${s}`).then(r=>r.json())
      ]);
      return {
        openInterestBybit: bp.result?.open_interest || '—',
        LS_Bybit: oir.result?.buy_ratio ? (oir.result.buy_ratio + '%') : '—'
      };
    }

    async function render() {
      const tell = ['BTC','ETH','SOL','XRP']; // مثال توضيحي
      let html = '<table><tr><th>رمز</th><th>سعر</th><th>24%</th><th>BN Funding</th><th>BN OI</th><th>BN L/S%</th><th>BY OI</th><th>BY L/S%</th></tr>';
      for (let sym of tell) {
        const dataMarket = (await fetch(`https://api.coingecko.com/api/v3/coins/markets?vs_currency=usd&ids=${sym.toLowerCase()}`)).json().then(j=>j[0]);
        const bin = await getBinanceInfo(sym);
        const by = await getBybitInfo(sym);
        html += `<tr><td>${sym}</td><td>${(await dataMarket).current_price.toFixed(2)}</td><td>${(await dataMarket).price_change_percentage_24h.toFixed(1)}%</td>
        <td>${bin.funding}</td><td>${bin.openInterest}</td><td>${bin.longShort}%</td>
        <td>${by.openInterestBybit}</td><td>${by.LS_Bybit}</td></tr>`;
      }
      html += '</table>';
      document.getElementById('tracker').innerHTML = html;
    }

    render();
    setInterval(render,60000);
  </script>
</body>
</html>
